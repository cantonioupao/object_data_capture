#:kivy 2.0.0

# Define reusable styles for consistent appearance
#:set primary_color (0.3, 0.8, 0.3, 1)
#:set text_color (1, 1, 1, 1)

<CaptureInterface>:
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size
    
    BoxLayout:
        orientation: 'vertical'
        padding: '10dp'
        spacing: '10dp'

        # Camera preview area with overlay
        RelativeLayout:
            size_hint_y: 0.8

            # Preview widget will be added programmatically
            Widget:
                id: preview_widget
            
            # Guidance overlay
            CaptureGuideOverlay:
                id: guidance_overlay

        # Status and controls area
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: 0.2
            spacing: '5dp'

            Label:
                id: status_label
                text: 'Initializing...'
                color: text_color
                font_size: '18sp'
                size_hint_y: 0.5
                text_size: self.size
                halign: 'center'
                valign: 'middle'

            Button:
                id: capture_button
                text: 'Capture'
                size_hint_y: 0.5
                background_color: primary_color
                font_size: '20sp'
                bold: True

<CaptureGuideOverlay>:
    canvas:
        # Center crosshair
        Color:
            rgba: 0, 1, 0, 0.6
        Line:
            points: [self.center_x - 20, self.center_y, self.center_x + 20, self.center_y]
            width: 1.5
        Line:
            points: [self.center_x, self.center_y - 20, self.center_x, self.center_y + 20]
            width: 1.5

        # Alignment rectangle
        Color:
            rgba: 0, 1, 0, 0.3
        Line:
            rectangle: [self.center_x - 100, self.center_y - 100, 200, 200]
            width: 1.5

        # Progress indicator background
        Color:
            rgba: 0.2, 0.2, 0.2, 0.8
        Rectangle:
            pos: dp(10), dp(10)
            size: dp(200), dp(30)

        # Progress bar
        Color:
            rgba: 0, 1, 0, 0.8
        Rectangle:
            pos: dp(10), dp(10)
            size: dp(200 * root.capture_progress), dp(30)

<CustomLabel@Label>:
    color: text_color
    font_size: '16sp'
    text_size: self.size
    halign: 'left'
    valign: 'middle'
    padding: '10dp', '5dp'